define("model/user",[],function(){function e(){this.conatinerSelector=".user-login",this.statusAttr="data-islogin",this.configSelector="#aj-user-sign-config",this.loginSuccessEventName="aj.userLoginSuccess",this.logoutSuccessEventName="aj.userLogoutSuccess"}return e.prototype={isLogin:function(){var e=$(this.configSelector)[0];if(!e.isLogin)return!1;try{return JSON.parse(e.isLogin.value)}catch(t){return!1}},getUserid:function(){var e=$(this.configSelector)[0];return e.userid?e.userid.value:0},getUserimg:function(){var e=$(this.configSelector)[0];return e.img?e.img.value:""},getNickname:function(){var e=$(this.configSelector)[0];return e.nickname?e.nickname.value:""},triggerLoginEvent:function(){$(window).trigger(this.loginSuccessEventName)},triggerLogoutEvent:function(){$(window).trigger(this.logoutSuccessEventName)},onLogin:function(e){$(window).on(this.loginSuccessEventName,e)},onLogout:function(e){$(window).on(this.logoutSuccessEventName,e)}},new e}),define("ui/comment",["model/user"],function(e){function t(){this.className="aj-comment-ui-area",this.groupIdAttr="data-grounp-id",this.hasRenderClassName="aj-comment-ui-area-has-rendered",this.commentsLoadUrl="/comment/get",this.textareaClassName="user-comment-area",this.placeHolderWhenLogin="亲, 说点什么吧~",this.placeHolderWhenLogout="登陆才可以评论哦~"}return t.prototype={getGroupId:function(e){return e.attr(this.groupIdAttr)},render:function(){var e=$("."+this.className),t=this;e.each(function(){t.renderDom(this)})},renderDom:function(e){this.hasRendered(e)||($(e).addClass(this.hasRenderClassName),this.renderHeader(e),this.renderComments(e),this.bindEvents(e))},bindEvents:function(t){var n=this;e.onLogin(function(){n.enableComment(t)}),e.onLogout(function(){n.disableComment(t)})},disableComment:function(e){$(e).find("."+this.textareaClassName).attr({disabled:"true",placeholder:this.placeHolderWhenLogout})},enableComment:function(e){$(e).find("."+this.textareaClassName).removeAttr("disabled").attr("placeholder",this.placeHolderWhenLogin)},renderHeader:function(t){var n=$("<div>"),o=$("<h3>");textarea=$("<textarea>"),btn=$("<button>"),o.html("用户评论:"),n.append(o),e.isLogin()?textarea.attr("placeholder","说点什么呗~"):(textarea.attr("placeholder","您未登录, 无法评论"),textarea.attr("disabled","true")),textarea.addClass("form-control"),textarea.addClass(this.textareaClassName),n.append(textarea),btn.html("提交"),btn.addClass("form-control"),btn.css({width:"80px"}),n.append(btn),$(t).append(n)},renderComments:function(e){jDom=$(e);var t=$("<div>"),n=this;$.ajax({url:this.commentsLoadUrl+"?commentsGroupId="+this.getGroupId(jDom),type:"GET",dataType:"json",success:function(e){var o;if(e.isok)for(o=0;o<e.data.length;o++)t.append(n.renderCommentJsonToDom(e.data[o]))},error:function(){t.html("加载失败"),t.css({padding:"20px",textAlign:"center"})},complete:function(){jDom.append(t)}})},renderCommentJsonToDom:function(e){var t=$("<div>");return t.html(e.userid+":"+e.content),t},hasRendered:function(e){return $(e).hasClass(this.hasRenderClassName)}},new t}),define("tools/tools",[],function(){var e={joinParams:function(e,t){for(var n=[],o=0;o<t.length;o++)n.push(t[o].key+"="+encodeURIComponent(t[o].val));return e+="?"+n.join("&")},openUrl:function(e){window.open(e,"oauth2Login_10914","height=525,width=585, toolbar=no, menubar=no, scrollbars=no, status=no, location=yes, resizable=yes")},logException:function(e){console.log("An error happen.."),console.log(e)},isLocal:function(){return"localhost"==location.hostname.toLowerCase()?!0:!1}};return e}),require(["ui/comment","model/user","tools/tools"],function(){}),define("requirejs-main",function(){});